apiVersion: v1
kind: Secret
metadata:
  name: cluster-CLUSTER_NAME
  namespace: argocd
  labels:
    argocd.argoproj.io/secret-type: cluster
    cluster-role: ROLE       # one of: dex, backend, 3rd-party, velocity, listeners
    env: ENV                 # one of: dev, stage, integration, prod
    region: REGION           # AWS region (e.g., eu-west-1) — used by multicluster ApplicationSets
    region-short: SHORT      # short name (e.g., euw1) — used in Application names and value file lookups
type: Opaque
stringData:
  name: CLUSTER_NAME
  server: https://CLUSTER_API_SERVER
  config: |
    {
      "bearerToken": "<token>",
      "tlsClientConfig": {
        "insecure": false,
        "caData": "<base64-ca>"
      }
    }
---
# Example: Register the in-cluster as a dex-dev cluster
#
# apiVersion: v1
# kind: Secret
# metadata:
#   name: cluster-dex-dev
#   namespace: argocd
#   labels:
#     argocd.argoproj.io/secret-type: cluster
#     cluster-role: dex
#     env: dev
#     region: eu-west-1
#     region-short: euw1
# type: Opaque
# stringData:
#   name: dex-dev
#   server: https://kubernetes.default.svc
#   config: |
#     {
#       "tlsClientConfig": {
#         "insecure": false
#       }
#     }
